<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta http-equiv="pragma" content="no-cache" />

    <title>HerStory</title>

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <script src="handlebars-v4.0.5.js"></script>
    <script src="jquery.dotdotdot.min.js"></script>
    <script src="data.js"></script>
    <script src="scripts.js"></script>
</head>

<body>

<!-- Top Nav test with git -->
<nav class="navbar navbar-fixed-top top-nav row container">
    <div class="col-xs-2">
        <span class="top-nav-item back" id="back">
            < Back
        </span>
    </div>

    <div class="top-nav-item title text-center col-xs-8">
        Local Stories
    </div>

    <div clas="col-xs-2 row">
        <a class="top-nav-item forward hide" href="#">
            Forward >
        </a>
        <a id="edit-button-top" class="top-nav-item col-xs-2 pull-right" href="#editing-my-profile">Edit</a>
    </div>
</nav>

<!-- Screens -->

<div class="container screen" id="local-stories-screen">
    <p class="muted text-center small">We've found a lot of local women just like you.<br>Connect with them by reading their stories and reaching out.</p>
    <div id="local-stories-rendered">
    </div>
</div>

<script id="local-story-card-template" type="text/x-handlebars-template">
    <div class="local-story-profile-card" onclick="document.location.hash = '{{user.firstName}}'">
        <div class="media">
            <div class="media-left media-middle">
                <img class="media-object profile-photo" src="img/{{user.img}}">
                <h5 class="text-center">{{user.fullName}}</h5>
            </div>
            <div class="media-body">
                <p class="profile-bio">{{user.cardBio}}</p>
                <hr style="" class="pretty-divider" />
                <h5 class="recent-chapters-title">Her recent chapters</h5>
                <ul class="recent-chapters-list">
                    <li>{{user.stories.1.title}}</li>
                    <li>{{user.stories.2.title}}</li>
                </ul>
            </div>
        </div>
    </div>
</script>

<div class="container screen" id="my-story-screen">

        <div class="media">
          <div class="media-left media-middle">
              <img class="media-object conversation-img" src="img/bunch-shawna.jpg">
          </div>
          <div class="media-body">
                <h4 class="message-name profile-name" id="my-name">Your Name</h4>
                <p id="profile-location" class="profile-location">Stanford, California</p>
                <p id="my-bio" class="profile-bio">Your bio</p>
                <div class="btn-outer text-center write-chapter">
                    <a class="btn btn-inner" href="#edit-chapter1">Write a New Chapter</a>
                </div>
          </div>
        </div>
        <hr class="pretty-divider">
        <div class="main" id="my-chapters-rendered">
            <!-- the chapters will go here from handlebars -->
        </div>


        <script id="my-story-template" type="text/x-handlebars-template">
            <div class="chapter">
                <h1 class="chapter-title">{{ title }}</h1>
                <p class="chapter-date"> March 13, 2017</p>
                <p class="chapter-text">{{ content }}</p>
            </div>
        </script>
</div>

<div class="container screen" id="conversations-screen">
    <p class="muted text-center small">Connect with more people by reading stories and starting conversations.</p>
    <hr class="profile-divider no-margin">
    <div id="conversations-index">

    </div>

    <script id="conversations-index-template" type="text/x-handlebars-template">
        <div class="conversation-link" onclick="document.location.hash = 'conversation-with-{{user.firstName}}'">
            <div class="media">
              <div class="media-left media-middle">
                  <img class="media-object conversation-img" src="img/{{user.img}}">
              </div>
              <div class="media-body">
                <h4 class="message-name">{{user.fullName}}</h4>
                <p>{{lastMessage}}</p>
              </div>
            </div>
        </div>
        <hr class="profile-divider no-margin">
    </script>
</div>

<div class="container screen" id="profile-screen">
    <div id="profile-rendered">

    </div>

    <script id="profile-template" type="text/x-handlebars-template">
        <div class="media">
          <div class="media-left media-middle">
              <img class="media-object conversation-img" src="img/{{user.img}}">
          </div>
          <div class="media-body">
                <h4 class="message-name">{{user.fullName}}</h4>
                <p class="profile-location">{{user.location}}</p>
                <p>{{user.bio}}</p>
                <div class="btn-outer text-center write-chapter">
                    <a class="btn btn-inner" href="#conversation-with-{{user.firstName}}">Start a Conversation</a>
                </div>
          </div>
        </div>
        <hr class="pretty-divider">
        {{#each user.stories}}
            <div class="chapter">
                <h1 class="chapter-title">{{ this.title }}</h1>
                <p class="chapter-date"> March 13, 2017</p>
                <p class="chapter-text">{{ this.content }}</p>
            </div>
        {{/each}}
    </script>
</div>

<div class="container screen" id="direct-conversation-screen">
    <p class="muted text-center small" id="empty-messages-text"></p>
    <div id="messages-index">
    </div>
    <div class="row message-input-row">
      <div class="col-xs-12 message-input-col">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Type Message" id="send-message-input">
          <span class="input-group-btn">
            <button class="btn btn-default" type="button" id="send-message-button">Send</button>
          </span>
        </div><!-- /input-group -->
      </div><!-- /.col-xs-12 -->
    </div><!-- /.row -->

    <script id="message-template" type="text/x-handlebars-template">
        {{#if sentFromMe}}
        <p class="triangle-border right">{{message}}</p>
        {{else}}
        <p class="triangle-border left">{{message}}</p>
        {{/if}}
    </script>
</div>

<div class="container screen" id="editing-my-profile-screen">
    <div class="editing-my-story">
        <div class="header">
            <img class="profile-photo img-responsive center-block" src="img/bunch-shawna.jpg">
            <input class="text-center profile-name" id="edit-profile-name" placeholder="Your Name"></input><br>
            <input class="text-center profile-location" id="edit-profile-location" value="Stanford, California" placeholder="Your Location"></input><br>
            <input class="text-center profile-bio" id="edit-profile-bio" placeholder="Write a brief bio"></input>
        </div>
        <hr style="" class="pretty-divider" />
        <!--div class="main">
            <div class="chapter">
                <input class="chapter-title" value="Starting on Anastrazole" placeholder="Chapter Title"></input>
                <input class="chapter-date form-control" value="March 8th, 2017" placeholder="Chapter Date"></input>
                <textarea class="chapter-text" rows="10" placeholder="Share something...">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pulvinar lacinia felis, at placerat dui finibus quis. Pellentesque vitae tellus cursus, laoreet metus sit amet, ornare diam. Donec finibus dignissim nibh, ut consectetur nunc tristique et. Sed in ipsum aliquam, ullamcorper dolor vitae, tempus magna. Phasellus gravida malesuada nisi, a malesuada erat laoreet in. Maecenas iaculis sem eget felis maximus venenatis. Aliquam erat volutpat. Integer vitae justo non ante blandit dapibus vitae eget enim. Vestibulum finibus suscipit mauris et aliquet. Morbi convallis viverra lorem eget cursus.
                </textarea>
            </div>
        </div-->
    </div>
</div>

<!-- WELCOME SCREENS ENSEMBLE -->
<div class="container screen" id="welcome1-screen">
	<center>
        <div class="row">
            <img class="img-responsive center-block welcrumb-breadcome" src="img/signup-img/p_bar_1.png">
        </div>
        <div id="welcome-message">
            <p class="welcome-pbar-label">Welcome! Please help us to learn more about you. Note that all profile information can be modified later.</p>
        </div>
	</center>
	<div class="container">
		<div class="row q_card">
			<p class="qcard_title">Name</p>
			<center>
			<input type="text" name="name" placeholder="Your name" id="name_input"/>
			</center>
		</div>
		<div class="row q_card">
			<p class="qcard_title">Profile Photo</p>
			<center>
                <img id="profile-image-preview" class="profile-photo img-responsive center-block hide" src="#" style="margin-bottom:15px"/>
    			<label for="file-upload" class="custom-file-upload">
    			     <p class="button-label" id="choose-photo">Choose A Photo</p>
    			</label>
    			<input id="file-upload" type="file" onchange="previewPic(this);"/>
			</center>
		</div>
		<div class="row q_card">
			<p class="qcard_title" >Age</p>
			<center>
			     <input type="number" placeholder="Your age" name="age" id="age_input"/>
			</center>
		</div>
		<div class="row q_card">
			<p class="qcard_title">Bio</p>
			 <textarea class="chapter-text" rows="3" placeholder="Tell us a little about yourself" name="bio" id="bio_input" style="height:130px" /></textarea>
		</div>
	</div>
</div>

<div class="container screen" id="welcome2-screen">
	<center>
        <div class="row">
            <img class="img-responsive center-block welcrumb-breadcome"  src="img/signup-img/p_bar_2.png">
        </div>
        <div id="welcome-message">
            <p class="welcome-pbar-label">You're doing great! Please tell us a little about your family.</p>
        </div>
	</center>
    <div class="container">
		<div class="row q_card_2">
			<p class="qcard_title">Marital Status</p>
			<center>
			<div class="row welcome-tab-row">
				<div id="marital-single" OnClick = "single()">Single</div>
				<div id="marital-married" OnClick = "married()">Married</div>
			</div>
			</center>
		</div>
		<div class="row q_card_2" >
			<p class="qcard_title">Have Children</p>
			<center>
			<div class="row welcome-tab-row" >
				<div id="kid-yes" OnClick = haveKid()>Yes</div>
				<div id="kid-no" OnClick = noKid()>No</div>
			</div>
			</center>
		</div>
	</div>
</div>

<div class="container screen" id="welcome3-screen">
	<center>
    <div class="row">
        <img class="img-responsive center-block welcrumb-breadcome" src="img/signup-img/p_bar_3.png">
    </div>
    <div id="welcome-message">
        <p class="welcome-pbar-label">Please tell us about your breast cancer stage and when were you diagnosed. This will help us match you with other members of the community.</p>
    </div>
	</center>
    <div class="container">
		<div class="row q_card_2" style="padding: 5px;">
			<p class="qcard_title">What stage are you at right now?</p>
			<center>
				<div class="row">
				<div id="stage-one" OnClick = "stageOne()">Stage I</div>
				<div id="stage-two" OnClick = "stageTwo()">Stage II</div>
				</div>
				<div class="row">
				<div id="stage-three" OnClick = "stageThree()">Stage III</div>
				<div id="stage-four" OnClick = "stageFour()">Stage IV</div>
				</div>
			</center>
		</div>
		<div class="row q_card_2" >
			<p class="qcard_title">When were you first diagnosed?</p>
			<center>
			<div class="row welcome-tab-row">
			<input type="month" name="diagnose" id="diagnose_input"/>
			<div>
			</center>
		</div>
	</div>
</div>

<div class="container screen" id="welcome4-screen">
    <div class="row">
        <img class="img-responsive center-block welcrumb-breadcome" src="img/signup-img/p_bar_4.png">
    </div>
    <div id="welcome-message">
        <p class="welcome-pbar-label">You're done! We'd now invite you to start writing the first chapter of your story. Think of this as you're online diary where you can share your thoughts and feelings with the community. No one but trusted members of the community can read these. </p>
    </div>
    <div class="container" style="border-top: thin solid #ff89a0; padding-top: 20px;">
		<!--p class="firstchapt-label">Title </p-->
        <input type="text" class="edit-chapter-title" name="stage" id="firstchapt-title" placeholder="Title of your Chapter" />

		<textarea placeholder="Here's where you can share your thoughts in the first chapter of your story. Be as expressive as you want. Let others know what you're going through. Here's where you can make a connection with others in the community." class="chapter-text" rows="10" id="firstchapt"></textarea>
	</div>
</div>

<div class="container screen" id="welcome5-screen">
    <div class="row">
        <img class="img-responsive center-block welcrumb-breadcome" src="img/signup-img/p_bar_4.png">
    </div>
    <div id="welcome-message">
        <p class="welcome-pbar-label">You're doing a fantastic job! Now we're at the "tag" page. Tags are a way to categorize your story - this helps members of the community find stories on topics that matter to them the most. Please tap on two tags below which you believe are most strongly associated with the chapter you just wrote.</p>
    </div>
	<center>
	<hr style="" class="pretty-divider" />
	<p class="welcome-tag-title"> The Treatment Process </p>
    <div class="row">
		<img class="firstchpt-tag-chemo" OnClick="chemoTag()" src="tags/chemo-tag.png"/>
		<img class="firstchpt-tag-medicine" OnClick="medicineTag()" src="tags/medicine-tag.png" />
	</div>
	<hr style="" class="pretty-divider" />
	<p class="welcome-tag-title"> Interactions at the Hospital </p>
	<div class="row">
		<img class="firstchpt-tag-hospital" OnClick="hospitalTag()" src="tags/hospital-tag.png"/>
		<img class="firstchpt-tag-surgery" OnClick="surgeryTag()" src="tags/surgery-tag.png" />
	</div>
	<hr style="" class="pretty-divider" />
	<p class="welcome-tag-title"> Things closest to your heart </p>
	<div class="row">
		<img class="firstchpt-tag-fam" OnClick="famTag()" src="tags/family-tag.png"/>
		<img class="firstchpt-tag-ref" OnClick="refTag()"  src="tags/reflection-tag.png"/>
	</div>
	</center>
</div>

<div class="container screen" id="edit-chapter1-screen">
    <div id="welcome-message">
        <p class="welcome-pbar-label">Think of this as you're online diary where you can share your thoughts and feelings with the community. No one but trusted members of the community can read these. </p>
    </div>
    <div class="container" style="border-top: thin solid #ff89a0; padding-top: 20px;">
        <!--p class="firstchapt-label">Title </p-->
        <input type="text" class="edit-chapter-title" name="stage" id="chapt-title" placeholder="Title of your Chapter" />

        <textarea placeholder="Here's where you can share your thoughts in the first chapter of your story. Be as expressive as you want. Let others know what you're going through. Here's where you can make a connection with others in the community." class="chapter-text" rows="10" id="chapt"></textarea>
    </div>
</div>

<div class="container screen" id="edit-chapter2-screen">
    <div id="welcome-message">
        <p class="welcome-pbar-label">Tags are a way to categorize your story - this helps members of the community find stories on topics that matter to them the most. Please tap on two tags below which you believe are most strongly associated with the chapter you just wrote.</p>
    </div>
    <center>
    <hr style="" class="pretty-divider" />
    <p class="welcome-tag-title"> The Treatment Process </p>
    <div class="row">
        <img class="firstchpt-tag-chemo" OnClick="chemoTag()" src="tags/chemo-tag.png"/>
        <img class="firstchpt-tag-medicine" OnClick="medicineTag()" src="tags/medicine-tag.png" />
    </div>
    <hr style="" class="pretty-divider" />
    <p class="welcome-tag-title"> Interactions at the Hospital </p>
    <div class="row">
        <img class="firstchpt-tag-hospital" OnClick="hospitalTag()" src="tags/hospital-tag.png"/>
        <img class="firstchpt-tag-surgery" OnClick="surgeryTag()" src="tags/surgery-tag.png" />
    </div>
    <hr style="" class="pretty-divider" />
    <p class="welcome-tag-title"> Things closest to your heart </p>
    <div class="row">
        <img class="firstchpt-tag-fam" OnClick="famTag()" src="tags/family-tag.png"/>
        <img class="firstchpt-tag-ref" OnClick="refTag()"  src="tags/reflection-tag.png"/>
    </div>
    </center>
</div>

<!-- Bottom Nav -->
<footer class="bottom-nav bg-faded" id="footer-menu">
    <div class="container">
        <div class="row">
            <div class="col-xs-4">
                <a href="#my-story">
                    <div class="bottom-nav-item text-center" id="my-story-nav">
                        <div class="nav-icon book"></div>
                        <span>My Story</span>
                    </div>
                </a>
            </div>
            <div class="col-xs-4 bordered-nav-item">
                <a href="#local-stories">
                    <div class="bottom-nav-item selected text-center" id="local-stories-nav">
                        <div class="nav-icon star"></div>
                        <span>Local Stories</span>
                    </div>
                </a>
            </div>
            <div class="col-xs-4">
                <a href="#conversations">
                    <div class="bottom-nav-item text-center" id="conversations-nav">
                        <div class="nav-icon conversations"></div>
                        <span>Conversations</span>
                    </div>
                </a>
            </div>
        </div>
    </div>
</footer>

<footer class="bottom-nav bg-faded row" id="footer-save">
    <h3><a href="#my-story" class="col-xs-6 text-center footer" onclick="setProfileData()" style="border-right: 1px dotted">Cancel</a></h3>
    <h3><a href="#my-story" class="col-xs-6 text-center footer" onclick="saveProfile()">Save</a></h3>
</footer>

<footer class="bottom-nav bg-faded row" id="footer-signup">
    <h3><a onclick="javascript:nextPage(-1)" class="col-xs-6 text-center footer" style="border-right: 1px dotted" id="footer-back-button">&lt Prev</a></h3>
    <h3><a onclick="javascript:nextPage(1)" class="col-xs-6 text-center footer" id="footer-next-button">Next &gt</a></h3>
</footer>

</body>
<script>
    // welcome screen - clicking next
    var nextPage = function(increment) {
        var increment = parseInt(increment)

        // get current welcome screen
        var docHash = document.location.hash;
        var currentWelcomeScreen = parseInt(docHash.substring(docHash.length - 1));

        // Check for edge cases
        const updatedScreen = currentWelcomeScreen + increment;

        // hard-code the two views where you'd show the bottom "NEXT" button as "DONE"
        if (increment == 1 && (document.location.hash == "#edit-chapter1" || document.location.hash == "#welcome4")) {
            $('#footer-next-button').html('DONE &gt');
        } else {
            $('#footer-next-button').html('Next &gt');
        }

        if (increment == -1 && document.location.hash == "#edit-chapter1") {
            document.location.hash = "#my-story";
            return;
        }

        // TODO: Perform checks before sending to my story view
        if (document.location.hash == "#edit-chapter2" && increment == 1) {
            // if this is the edit chapter view's second page,
            // it's time to save to the myStoriesData array
            appendChapterToStory();

            // take them to the my story page
            document.location.hash = "#my-story";
            return;
        }

        if (updatedScreen == 6) {
            // This is only for the "Welcome" view.
            // NOTE: legacy and inefficient code but will NOT be changed at this stage.
            // update the user's story
            appendChapterToStory();

            // take them to the my story page
            document.location.hash = "#my-story";
        }

        if (updatedScreen < 1 || updatedScreen > 5) {
            return;
        } else {
            // grey out BACK button if 1
            if (updatedScreen == 1) {
                $("#footer-back-button").addClass("greyed-out");
            } else {
                $("#footer-back-button").removeClass("greyed-out");
            }

            // increment and call the next page in the series
            document.location.hash = docHash.substring(1, docHash.length-1) + String(updatedScreen);
        }
    }

    // preview profile picture
    function previewPic(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#profile-image-preview')
                    .attr('src', e.target.result)
                    .removeClass('hide');
                $('#choose-photo').html("Choose Another Photo");
            };

            reader.readAsDataURL(input.files[0]);
        }
    }

    // clicking save button while editing profile
    function saveProfile() {
        $('#profile-location').html($('#edit-profile-location').val());
        $('#my-bio').html($('#edit-profile-bio').val());
        $('#my-name').html($('#edit-profile-name').val());
    }
</script>
</html>
